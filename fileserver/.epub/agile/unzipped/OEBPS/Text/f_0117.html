<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title>Agile Web Development with Rails</title>
  <link href="../Styles/bookshelf.css" rel="stylesheet" type="text/css" />
  <link href="../Styles/book_local.css" rel="stylesheet" type="text/css" />
  <link href="../Styles/page-template.xpgt" rel="stylesheet" type="application/vnd.adobe-page-template+xml" />
  <meta content="rails4" name="bookcode" />
  <style type="text/css">
/*<![CDATA[*/

  code.sgc-1 {white-space: pre-wrap;}
  /*]]>*/
  </style>
</head>

<body>
  <h2 id="sec.helpers">21.5 Using Helpers</h2>

  <p id="N1C8D2">Earlier we said that it’s OK to put code in templates. Now we’re going to modify that statement. It’s perfectly acceptable to put <span class="emph">some</span> code in templates&mdash;that’s what makes them dynamic. However, it’s poor style to put too much code in templates.</p>

  <p id="N1C8D8">There are three main reasons for this. First, the more code you put in the view side of your application, the easier it is to let discipline slip and start adding application-level functionality to the template code. This is definitely poor form; you want to put application stuff in the controller and model layers so that it is available everywhere. This will pay off when you add new ways of viewing the application.</p>

  <p id="N1C8E1">The second reason is that <code class="cf ic">html.erb</code> is basically HTML. When you edit it, you’re editing an HTML file. If you have the luxury of having professional designers create your layouts, they’ll want to work with HTML. Putting a bunch of Ruby code in there just makes it hard to work with.</p>

  <p id="N1C8E7">The final reason is that code embedded in views is hard to test, whereas code split out into helper modules can be isolated and tested as individual units.</p>

  <p id="N1C8EA">Rails provides a nice compromise in the form of helpers. A <span class="emph">helper</span> is simply a module containing methods that assist a view. Helper methods are output-centric. They exist to generate HTML (or XML, or JavaScript)&mdash;a helper extends the behavior of a template.</p>

  <h3 id="heading_id_2">Your Own Helpers</h3>

  <p id="N1C8F4">By default, each controller gets its own helper module. Additionally, there is an application-wide helper named <code class="cf filename">application_helper.rb</code>. It won’t be surprising to learn that Rails makes certain assumptions to help link the helpers into the controller and its views. While all view helpers are available to all controllers, it often is good practice to organize helpers. Helpers that are unique to the views associated with the <code class="cf class">ProductController</code> tend to be placed in a helper module called <code class="cf class">ProductHelper</code> in the file <code class="cf filename">product_helper.rb</code> in the <code class="cf dir">app/helpers</code> directory. You don’t have to remember all these details&mdash;the <code class="cf commandname">rails generate controller</code> script creates a stub helper module automatically.</p>

  <p id="N1C91C">In Section 11.4, <a href="../Text/f_0069.html#sec.hiding.cart">​<em>Iteration F4: Hiding an Empty Cart</em>​</a>, we created such a helper method named <code class="cf methodname">hidden_div_if</code>, which enabled us to hide the cart under specified conditions. We can use the same technique to clean up the application layout a bit. At the present time we have the following:</p>

  <table class="processedcode">
    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1"><strong class="prompt">&lt;h3&gt;</strong>&lt;%= @page_title || <em class="string">"Pragmatic Store"</em> %&gt;<strong class="prompt">&lt;/h3&gt;</strong></code></td>
    </tr>
  </table>

  <p id="N1C937">Let’s move the code that works out the page title into a helper method. Because we’re in the store controller, we edit the file <code class="cf filename">store_helper.rb</code> in <code class="cf dir">app/helpers</code>.</p>

  <table class="processedcode">
    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1"><strong class="prompt">module</strong> StoreHelper</code></td>
    </tr>

    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1"><strong class="prompt">def</strong> page_title</code></td>
    </tr>

    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1">@page_title || <em class="string">"Pragmatic Store"</em></code></td>
    </tr>

    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1"><strong class="prompt">end</strong></code></td>
    </tr>

    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1"><strong class="prompt">end</strong></code></td>
    </tr>
  </table>

  <p id="N1C966">Now the view code simply calls the helper method:</p>

  <table class="processedcode">
    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1"><strong class="prompt">&lt;h3&gt;</strong>&lt;%= page_title %&gt;<strong class="prompt">&lt;/h3&gt;</strong></code></td>
    </tr>
  </table>

  <p id="N1C978">(We might want to eliminate even more duplication by moving the rendering of the entire title into a separate partial template, shared by all the controller’s views, but we don’t talk about them until <a href="../Text/f_0118.html#sec.partial.template">​<em>Partial-Page Templates</em>​</a>.)</p>

  <h3 id="heading_id_3">Helpers for Formatting and Linking</h3>

  <p id="N1C982">Rails comes with a bunch of built-in helper methods, available to all views. In this section, we’ll touch on the highlights, but you’ll probably want to look at the Action View RDoc for the specifics&mdash;there’s a lot of functionality in there.</p>

  <h4 id="heading_id_4">Formatting Helpers</h4>

  <p id="N1C989">One set of helper methods deals with dates, numbers, and text.</p>

  <dl>
    <dt class="force-newline"><code class="cf ic">&lt;%= distance_of_time_in_words(Time.now, Time.local(2010, 12, 25)) %&gt;</code></dt>

    <dd>
      <p id="N1C9B5">9 months</p>
    </dd>

    <dt class="force-newline"><code class="cf ic">&lt;%= distance_of_time_in_words(Time.now, Time.now + 33, false) %&gt;</code></dt>

    <dd>
      <p id="N1C9BE">1 minute</p>
    </dd>

    <dt class="force-newline"><code class="cf ic">&lt;%= distance_of_time_in_words(Time.now, Time.now + 33, true) %&gt;</code></dt>

    <dd>
      <p id="N1C9C7">Half a minute</p>
    </dd>

    <dt class="force-newline"><code class="cf ic">&lt;%= time_ago_in_words(Time.local(2010, 12, 25)) %&gt;</code></dt>

    <dd>
      <p id="N1C9DB">9 months</p>
    </dd>

    <dt class="force-newline"><code class="cf ic">&lt;%= number_to_currency(123.45) %&gt;</code></dt>

    <dd>
      <p id="N1C9EF">$123.45</p>
    </dd>

    <dt class="force-newline"><code class="cf ic">&lt;%= number_to_currency(234.56, unit: "CAN$", precision: 0) %&gt;</code></dt>

    <dd>
      <p id="N1C9F8">CAN$235</p>
    </dd>

    <dt class="force-newline"><code class="cf ic">&lt;%= number_to_human_size(123_456) %&gt;</code></dt>

    <dd>
      <p id="N1CA0C">120.6 KB</p>
    </dd>

    <dt class="force-newline"><code class="cf ic">&lt;%= number_to_percentage(66.66666) %&gt;</code></dt>

    <dd>
      <p id="N1CA20">66.667%</p>
    </dd>

    <dt class="force-newline"><code class="cf ic">&lt;%= number_to_percentage(66.66666, precision: 1) %&gt;</code></dt>

    <dd>
      <p id="N1CA29">66.7%</p>
    </dd>

    <dt class="force-newline"><code class="cf ic">&lt;%= number_to_phone(2125551212) %&gt;</code></dt>

    <dd>
      <p id="N1CA3D">212-555-1212</p>
    </dd>

    <dt class="force-newline"><code class="cf ic">&lt;%= number_to_phone(2125551212, area_code: true, delimiter: " ") %&gt;</code></dt>

    <dd>
      <p id="N1CA46">(212) 555 1212</p>
    </dd>

    <dt class="force-newline"><code class="cf ic">&lt;%= number_with_delimiter(12345678) %&gt;</code></dt>

    <dd>
      <p id="N1CA5A">12,345,678</p>
    </dd>

    <dt class="force-newline"><code class="cf ic">&lt;%= number_with_delimiter(12345678, delimiter: "_") %&gt;</code></dt>

    <dd>
      <p id="N1CA63">12_345_678</p>
    </dd>

    <dt class="force-newline"><code class="cf ic">&lt;%= number_with_precision(50.0/3, precision: 2) %&gt;</code></dt>

    <dd>
      <p id="N1CA77">16.67</p>
    </dd>
  </dl>

  <p id="N1CA7A">The <code class="cf methodname">debug</code> method dumps out its parameter using YAML and escapes the result so it can be displayed in an HTML page. This can help when trying to look at the values in model objects or request parameters.</p>

  <p id="N1CA8B"><code class="cf ic">&lt;%= debug(params) %&gt;</code></p>

  <table class="processedcode">
    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1">--- !ruby/hash:HashWithIndifferentAccess</code></td>
    </tr>

    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1">name: <em class="string">Dave</em></code></td>
    </tr>

    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1">language: <em class="string">Ruby</em></code></td>
    </tr>

    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1">action: <em class="string">objects</em></code></td>
    </tr>

    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1">controller: <em class="string">test</em></code></td>
    </tr>
  </table>

  <p id="N1CAAE">Yet another set of helpers deals with text. There are methods to truncate strings and highlight words in a string.</p>

  <dl>
    <dt class="force-newline"><code class="cf ic">&lt;%= simple_format(@trees) %&gt;</code></dt>

    <dd>
      <p id="N1CAC3">Formats a string, honoring line and paragraph breaks. You could give it the plain text of the Joyce Kilmer poem <span class="emph">Trees</span>, and it would add the HTML to format it as follows.</p>

      <p id="N1CAC9">&lt;p&gt; I think that I shall never see &lt;br /&gt;A poem lovely as a tree.&lt;/p&gt; &lt;p&gt;A tree whose hungry mouth is prest &lt;br /&gt;Against the sweet earth’s flowing breast; &lt;/p&gt;</p>
    </dd>

    <dt class="force-newline"><code class="cf ic">&lt;%= excerpt(@trees, "lovely", 8) %&gt;</code></dt>

    <dd>
      <p id="N1CADD">...A poem lovely as a tre...</p>
    </dd>

    <dt class="force-newline"><code class="cf ic">&lt;%= highlight(@trees, "tree") %&gt;</code></dt>

    <dd>
      <p id="N1CAF1">I think that I shall never see A poem lovely as a &lt;strong class="highlight"&gt;tree&lt;/strong&gt;. A &lt;strong class="highlight"&gt;tree&lt;/strong&gt; whose hungry mouth is prest Against the sweet earth’s flowing breast;</p>
    </dd>

    <dt class="force-newline"><code class="cf ic">&lt;%= truncate(@trees, length: 20) %&gt;</code></dt>

    <dd>
      <p id="N1CB05">I think that I sh...</p>
    </dd>
  </dl>

  <p id="p.pluralize">There’s a method to pluralize nouns.</p>

  <dl>
    <dt class="force-newline"><code class="cf ic">&lt;%= pluralize(1, "person") %&gt; but &lt;%= pluralize(2, "person") %&gt;</code></dt>

    <dd>
      <p id="N1CB1E">1 person but 2 people</p>
    </dd>
  </dl>

  <p id="N1CB21">If you’d like to do what the fancy websites do and automatically hyperlink URLs and email addresses, there are helpers to do that. There’s another that strips hyperlinks from text.</p>

  <p id="N1CB24">Back in <a href="../Text/f_0045.html#p.cycle">​​</a>, we saw how the <code class="cf methodname">cycle</code> helper can be used to return the successive values from a sequence each time it’s called, repeating the sequence as necessary. This is often used to create alternating styles for the rows in a table or list. <code class="cf methodname">current_cycle</code> and <code class="cf methodname">reset_cycle</code> methods are also available.</p>

  <p id="N1CB3E">Finally, if you’re writing something like a blog site or you’re allowing users to add comments to your store, you could offer them the ability to create their text in Markdown (BlueCloth)<a href="../Text/f_0118.html#FOOTNOTE-50" id="FNPTR-50">[50]</a> or Textile (RedCloth)<a href="../Text/f_0118.html#FOOTNOTE-51" id="FNPTR-51">[51]</a> format. These are simple formatters that take text with very simple, human-friendly markup and convert it into HTML.</p>

  <h4 id="heading_id_5">Linking to Other Pages and Resources</h4>

  <p id="N1CB65">The<code class="cf class">ActionView::Helpers::AssetTagHelper</code> and <code class="cf class">ActionView::Helpers::UrlHelper</code> modules contain a number of methods that let you reference resources external to the current template. Of these, the most commonly used is <code class="cf methodname">link_to</code>, which creates a hyperlink to another action in your application:</p>

  <table class="processedcode">
    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1">&lt;<em class="string">%= link_to "Add Comment", new_comments_path %&gt;</em></code></td>
    </tr>
  </table>

  <p id="N1CB90">The first parameter to <code class="cf methodname">link_to</code> is the text displayed for the link. The next is a string or hash specifying the link’s target.</p>

  <p id="N1CB97">An optional third parameter provides HTML attributes for the generated link:</p>

  <table class="processedcode">
    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1">&lt;%= link_to <em class="string">"Delete"</em>, product_path(@product),</code></td>
    </tr>

    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1">{ class: <em class="string">"dangerous"</em>, method: <em class="string">'delete'</em> }</code></td>
    </tr>

    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1">%&gt;</code></td>
    </tr>
  </table>

  <p id="N1CBB4">This third parameter also supports two additional options that modify the behavior of the link. Each requires JavaScript to be enabled in the browser.</p>

  <p id="N1CBB7">The <code class="cf ic">:method</code> option is a hack&mdash;it allows you to make the link look to the application as if the request were created by a POST, PUT, or DELETE, rather than the normal GET method. This is done by creating a chunk of JavaScript that submits the request when the link is clicked&mdash;if JavaScript is disabled in the browser, a GET will be generated.</p>

  <p id="N1CBD4">The <code class="cf ic">:confirm</code> option takes a short message. If present, JavaScript will be generated to display the message and get the user’s confirmation before the link is followed:</p>

  <table class="processedcode">
    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1">&lt;%= link_to <em class="string">"Delete"</em>, product_path(@product),</code></td>
    </tr>

    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1">{ class: <em class="string">"dangerous"</em>,</code></td>
    </tr>

    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1">confirm: <em class="string">"Are you sure?"</em>,</code></td>
    </tr>

    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1">method: :delete}</code></td>
    </tr>

    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1">%&gt;</code></td>
    </tr>
  </table>

  <p id="N1CC11">The <code class="cf methodname">button_to</code> method works the same as <code class="cf methodname">link_to</code> but generates a button in a self-contained form, rather than a straight hyperlink. This is the preferred method of linking to actions that have side effects. However, these buttons live in their own forms, which imposes a couple of restrictions: they cannot appear inline, and they cannot appear inside other forms.</p>

  <p id="N1CC25">Rails has conditional linking methods that generate hyperlinks if some condition is met and just return the link text otherwise. <code class="cf methodname">link_to_if</code> and <code class="cf methodname">link_to_unless</code> take a condition parameter, followed by the regular parameters to <code class="cf ic">link_to</code>. If the condition is <code class="cf ic">true</code> (for <code class="cf ic">link_to_if</code>) or <code class="cf ic">false</code> (for <code class="cf ic">link_to_unless</code>), a regular link will be created using the remaining parameters. If not, the name will be added as plain text (with no hyperlink).</p>

  <p id="N1CC53">The <code class="cf methodname">link_to_unless_current</code> helper creates menus in sidebars where the current page name is shown as plain text and the other entries are hyperlinks:</p>

  <table class="processedcode">
    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1"><strong class="prompt">&lt;ul&gt;</strong></code></td>
    </tr>

    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1">&lt;% <em class="string">%w{ create list edit save logout }</em>.each <strong class="prompt">do</strong> |action| %&gt;</code></td>
    </tr>

    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1"><strong class="prompt">&lt;li&gt;</strong></code></td>
    </tr>

    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1">&lt;%= link_to_unless_current(action.capitalize, action: action) %&gt;</code></td>
    </tr>

    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1"><strong class="prompt">&lt;/li&gt;</strong></code></td>
    </tr>

    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1">&lt;% <strong class="prompt">end</strong> %&gt;</code></td>
    </tr>

    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1"><strong class="prompt">&lt;/ul&gt;</strong></code></td>
    </tr>
  </table>

  <p id="N1CC90">The <code class="cf methodname">link_to_unless_current</code> helper may also be passed a block that is evaluated only if the current action is the action given, effectively providing an alternative to the link. There also is a <code class="cf methodname">current_page</code> helper method that simply tests whether the current request URI was generated by the given options.</p>

  <p id="N1CCAF">As with <code class="cf methodname">url_for</code>, <code class="cf methodname">link_to</code> and friends also support absolute URLs:</p>

  <table class="processedcode">
    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1">&lt;%= link_to(<em class="string">"Help"</em>, <em class="string">"http://my.site/help/index.html"</em>) %&gt;</code></td>
    </tr>
  </table>

  <p id="N1CCC9">The <code class="cf methodname">image_tag</code> helper creates <code class="cf xmltag">&lt;img&gt;</code> tags. Optional <code class="cf ic">:size</code> parameters (of the form <span class="emph">width</span> <code class="cf ic">x</code> <span class="emph">height</span>), or separate width and height parameters, define the size of the image:</p>

  <table class="processedcode">
    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1">&lt;%= image_tag(<em class="string">"/images/dave.png"</em>, class: <em class="string">"bevel"</em>, size: <em class="string">"80x120"</em>) %&gt;</code></td>
    </tr>

    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1">&lt;%= image_tag(<em class="string">"/images/andy.png"</em>, class: <em class="string">"bevel"</em>,</code></td>
    </tr>

    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1">width: <em class="string">"80"</em>, height: <em class="string">"120"</em>) %&gt;</code></td>
    </tr>
  </table>

  <p id="N1CD0D">If you don’t give an <code class="cf ic">:alt</code> option, Rails synthesizes one for you using the image’s filename. If the image path doesn’t start with a / character, Rails assumes that it lives under the <code class="cf dir">/images</code> directory.</p>

  <p id="N1CD16">You can make images into links by combining <code class="cf methodname">link_to</code> and <code class="cf methodname">image_tag</code>:</p>

  <table class="processedcode">
    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1">&lt;%= link_to(image_tag(<em class="string">"delete.png"</em>, size: <em class="string">"50x22"</em>),</code></td>
    </tr>

    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1">product_path(@product),</code></td>
    </tr>

    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1">{ confirm: <em class="string">"Are you sure?"</em>,</code></td>
    </tr>

    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1">method: :delete})</code></td>
    </tr>

    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1">%&gt;</code></td>
    </tr>
  </table>

  <p id="N1CD3F">The <code class="cf methodname">mail_to</code> helper creates a <code class="cf ic">mailto:</code> hyperlink that, when clicked, normally loads the client’s email application. It takes an email address, the name of the link, and a set of HTML options. Within these options, you can also use <code class="cf ic">:bcc</code>, <code class="cf ic">:cc</code>, <code class="cf ic">:body</code>, and <code class="cf ic">:subject</code> to initialize the corresponding email fields. Finally, the magic option <code class="cf ic">encode: "javascript"</code> uses client-side JavaScript to obscure the generated link, making it harder for spiders to harvest email addresses from your site. Unfortunately, it also means your users won’t see the email link if they have JavaScript disabled in their browsers.</p>

  <table class="processedcode">
    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1">&lt;%= mail_to(<em class="string">"support@pragprog.com"</em>, <em class="string">"Contact Support"</em>,</code></td>
    </tr>

    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1">subject: <em class="string">"Support question from</em> #{@user.name}<em class="string">"</em>,</code></td>
    </tr>

    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1">encode: <em class="string">"javascript"</em>) %&gt;</code></td>
    </tr>
  </table>

  <p id="N1CE03">As a weaker form of obfuscation, you can use the <code class="cf ic">:replace_at</code> and <code class="cf ic">:replace_dot</code> options to replace the at sign and dots in the displayed name with other strings. This is unlikely to fool harvesters.</p>

  <p id="p.inc.stylesheet">The <code class="cf class">AssetTagHelper</code> module also includes helpers that make it easy to link to stylesheets and JavaScript code from your pages and to create autodiscovery Atom feed links. We created links in the layouts for the Depot application using the <code class="cf methodname">stylesheet_link_tag</code> and <code class="cf methodname">javascript_link_tag</code> methods in the head:</p>

  <table class="processedcode">
    <tr class="livecodelozenge">
      <td colspan="2"><a href="http://media.pragprog.com/titles/rails4/code/rails31/depot_r/app/views/layouts/application.html.erb">rails31/depot_r/app/views/layouts/application.html.erb</a></td>
    </tr>

    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1">&lt;!DOCTYPE html&gt;</code></td>
    </tr>

    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1"><strong class="prompt">&lt;html&gt;</strong></code></td>
    </tr>

    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1"><strong class="prompt">&lt;head&gt;</strong></code></td>
    </tr>

    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1"><strong class="prompt">&lt;title&gt;</strong>Pragprog Books Online Store<strong class="prompt">&lt;/title&gt;</strong></code></td>
    </tr>

    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1">&lt;%= stylesheet_link_tag <em class="string">"application"</em> %&gt;</code></td>
    </tr>

    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1">&lt;%= javascript_include_tag <em class="string">"application"</em> %&gt;</code></td>
    </tr>

    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1">&lt;%= csrf_meta_tag %&gt;</code></td>
    </tr>

    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1"><strong class="prompt">&lt;/head&gt;</strong></code></td>
    </tr>
  </table>

  <p id="N1CE5E">The <code class="cf methodname">stylesheet_link_tag</code> method can also take a parameter named <code class="cf ic">:all</code>, indicating that all styles in the stylesheet directory will be included. Adding <code class="cf ic">recursive: true</code> will cause Rails to include all styles in all subdirectories too.</p>

  <p id="N1CE75">The <code class="cf methodname">javascript_include_tag</code> method takes a list of JavaScript filenames (assumed to live in <code class="cf dir">public/javascripts</code>) and creates the HTML to load these into a page. In addition to <code class="cf ic">:all</code>, <code class="cf ic">javascript_include_tag</code> accepts as a parameter the value <code class="cf ic">:defaults</code>, which acts as a shortcut and causes Rails to load jQuery.js.</p>

  <p id="N1CE92">An RSS or Atom link is a header field that points to a URL in our application. When that URL is accessed, the application should return the appropriate RSS or Atom XML:</p>

  <table class="processedcode">
    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1"><strong class="prompt">&lt;html&gt;</strong></code></td>
    </tr>

    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1"><strong class="prompt">&lt;head&gt;</strong></code></td>
    </tr>

    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1">&lt;%= auto_discovery_link_tag(:atom, products_url(format: <em class="string">'atom'</em>)) %&gt;</code></td>
    </tr>

    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1"><strong class="prompt">&lt;/head&gt;</strong></code></td>
    </tr>

    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1">. . .</code></td>
    </tr>
  </table>

  <p id="N1CEC6">Finally, the <code class="cf class">JavaScriptHelper</code> module defines a number of helpers for working with JavaScript. These create JavaScript snippets that run in the browser to generate special effects and to have the page dynamically interact with our application.</p>

  <p id="N1CED8">By default, image and stylesheet assets are assumed to live in the <code class="cf dir">images</code> and <code class="cf dir">stylesheets</code> directories relative to the application’s <code class="cf dir">public</code> directory. If the path given to an asset tag method starts with a forward slash, then the path is assumed to be absolute, and no prefix is applied. Sometimes it makes sense to move this static content onto a separate box or to different locations on the current box. Do this by setting the configuration variable <code class="cf variable">asset_host</code>:</p>

  <table class="processedcode">
    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1">config.action_controller.asset_host = <em class="string">"http://media.my.url/assets"</em></code></td>
    </tr>
  </table>

  <p id="N1CF09">Although this list of helpers may seem to be comprehensive, Rails provides many more, new helpers are introduced with each release, and a select few are retired or moved off into a plugin where they can be evolved at a different pace than Rails itself. Now would be a good time to review the online documentation that you produced <a href="../Text/f_0100.html#p.rake.doc">​here​</a> to see what other goodies Rails provides for you.</p><script src="../Misc/book_local.js" type="text/javascript">
</script>
</body>
</html>
