<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title>Agile Web Development with Rails</title>
  <link href="../Styles/bookshelf.css" rel="stylesheet" type="text/css" />
  <link href="../Styles/book_local.css" rel="stylesheet" type="text/css" />
  <link href="../Styles/page-template.xpgt" rel="stylesheet" type="application/vnd.adobe-page-template+xml" />
  <meta content="rails4" name="bookcode" />
</head>

<body>
  <h1 class="chapter-title" id="chp.deployment"><span class="chapter-number">Chapter 16</span><br />
  <span class="chapter-name">Task K: Deployment and Production</span></h1>

  <div class="epigraph epitext">
    <ul>
      <li>
        <p id="N17ED9">running our application in a production web server,</p>
      </li>

      <li>
        <p id="N17EDD">configuring the database for MySQL,</p>
      </li>

      <li>
        <p id="N17EE1">using Bundler and Git for version control, and</p>
      </li>

      <li>
        <p id="N17EE5">deploying our application using Capistrano.</p>
      </li>
    </ul>
  </div>

  <div class="xxxsays">
    <div class="heading">
      <div class="persons-picture"><img alt="Joe asks:" src="../Images/joe.jpg" /></div>

      <div class="label">
        Joe asks:
      </div>

      <div class="title">
        Can I Deploy to Microsoft Windows?
      </div>
    </div>

    <div class="body">
      <p id="N17EEB">Although you can deploy applications to Windows environments, the overwhelming amount of Rails tools and shared knowledge assumes a Unix-based operating system such as Linux or Mac OS X. One such tool, Phusion Passenger, is highly recommended by the Ruby on Rails development team and covered in this chapter.</p>

      <p id="N17EEE">The techniques described in this chapter can be used by those developing on Windows and deploying to Linux or Mac OS X.</p>
    </div>
  </div>

  <p id="N17EF2">Deployment is supposed to mark a happy point in the lifetime of our application. It’s when we take the code that we’ve so carefully crafted and upload it to a server so that other people can use it. It’s when the beer, champagne, and hors d’oeuvres are supposed to flow. Shortly thereafter, our application will be written about in <span class="emph">Wired</span> magazine, and we’ll be overnight names in the geek community.</p>

  <p id="N17F09">The reality, however, is that it often takes quite a bit of up-front planning in order to pull off a smooth and repeatable deployment of your application.</p>

  <p id="N17F0C">By the time we are through with this chapter, our setup will look like Figure 41, <a href="#fig.prod.webserver.arch">​<em>Application deployment road map</em>​</a>.</p>

  <p id="N17F12">At the moment, we’ve been doing all of our work on one machine, though user interaction with our web server <span class="emph">could</span> be done on a separate machine. In the figure, the user’s machine is in the center, and the WEBRick web server is on the left. This server makes use of SQLite3, various gems you have installed, and your application code. Your code may or may not have also been placed in Git by this point; either way, it will be by the end of the chapter, as will be the gems you are using.</p>

  <p id="N17F18">This Git repository will be replicated on the production server, which again could be another machine but need not be. This server will be running a combination of Apache httpd and Phusion Passenger. This code will access a MySQL database on what may yet be a <span class="emph">fourth</span> machine.</p>

  <p id="N17F1E">Capistrano will be the tool we use to update the deployment server(s) remotely, safely, and repeatably from the comfort of our development machine.</p>

  <table class="figure" id="fig.prod.webserver.arch">
    <tr>
      <td><img alt="images/prod_webserver_arch.png" src="../Images/prod_webserver_arch.png" xmlns:str="http://exslt.org/strings" /></td>
    </tr>

    <tr>
      <td align="center">
        <hr />
        <b>Figure 41. Application deployment road map</b>
      </td>
    </tr>
  </table>

  <p id="N17F2D">That’s a lot of moving parts!</p>

  <p id="N17F30">Instead of doing it all at once, we will do it in three iterations. Iteration K1 will get the Depot application up and running with Apache, MySQL, and Passenger&mdash;a truly production-quality web server environment.</p>

  <p id="N17F33">We will leave Git, Bundler, and Capistrano to a second iteration. These tools will enable us to separate our development activities from our deployment environment. This means that by the time we are done, we will be deploying twice; but that’s only this first time and only to ensure that each of the parts are working independently. It also allows us to focus on a smaller set of variables at any one time, which will simplify the process of untangling any problems that we might encounter.</p>

  <p id="N17F36">In a third iteration, we will cover various administrative and cleanup tasks. Let’s get started!</p><script src="../Misc/book_local.js" type="text/javascript">
</script>
</body>
</html>
