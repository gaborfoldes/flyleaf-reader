<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title>Agile Web Development with Rails</title>
  <link href="../Styles/bookshelf.css" rel="stylesheet" type="text/css" />
  <link href="../Styles/book_local.css" rel="stylesheet" type="text/css" />
  <link href="../Styles/page-template.xpgt" rel="stylesheet" type="application/vnd.adobe-page-template+xml" />
  <meta content="rails4" name="bookcode" />
  <style type="text/css">
/*<![CDATA[*/

  code.sgc-1 {white-space: pre-wrap;}
  /*]]>*/
  </style>
</head>

<body>
  <h2 id="heading_id_2">8.3 Iteration C3: Using a Helper to Format the Price</h2>

  <p id="N13437">Ruby provides a <code class="cf methodname">sprintf</code> function that can be used to format prices. We could place logic that makes use of this function directly in the view. For example, we could say this:</p>

  <table class="processedcode">
    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1"><strong class="prompt">&lt;span</strong> class=<em class="string">"price"</em> <strong class="prompt">&gt;</strong> <em class="comment">&lt;%= sprintf("$%0.02f", product.price) %&gt;</em> <strong class="prompt">&lt;/span&gt;</strong></code></td>
    </tr>
  </table>

  <p id="N1345A">This would work, but it embeds knowledge of currency formatting into the view. Should we display prices of products in several places and want to internationalize the application later, this would be a maintenance problem.</p>

  <p id="N1345D">Instead, let’s use a helper method to format the price as a currency. Rails has an appropriate one built in&mdash;it’s called <code class="cf methodname">number_to_currency</code>.</p>

  <p id="N13479">Using our helper in the view is simple; in the index template, we change this:</p>

  <table class="processedcode">
    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1"><strong class="prompt">&lt;span</strong> class=<em class="string">"price"</em> <strong class="prompt">&gt;</strong> <em class="comment">&lt;%= product.price %&gt;</em> <strong class="prompt">&lt;/span&gt;</strong></code></td>
    </tr>
  </table>

  <p id="N13491">to the following:</p>

  <table class="processedcode">
    <tr class="livecodelozenge">
      <td colspan="2"><a href="http://media.pragprog.com/titles/rails4/code/rails31/depot_e/app/views/store/index.html.erb">rails31/depot_e/app/views/store/index.html.erb</a></td>
    </tr>

    <tr>
      <td class="codeprefix">&nbsp;</td>

      <td class="codeline"><code class="sgc-1"><strong class="prompt">&lt;span</strong> class=<em class="string">"price"</em> <strong class="prompt">&gt;</strong>&lt;%= number_to_currency(product.price) %&gt;<strong class="prompt">&lt;/span&gt;</strong></code></td>
    </tr>
  </table>

  <p id="N134AF">Sure enough, when we hit Refresh, we see a nicely formatted price:</p>

  <div xmlns:str="http://exslt.org/strings"><img alt="images/depot_f_format_price.png" src="../Images/depot_f_format_price.png" /></div>

  <p id="N134B5">Although it looks nice enough, we are starting to get a nagging feeling that we really should be running and writing tests for all this new functionality, particularly after our experience of adding logic to our model.</p><script src="../Misc/book_local.js" type="text/javascript">
</script>
</body>
</html>
